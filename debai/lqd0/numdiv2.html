<div class="tm-box2">
<div class="problem-name">
    NUMDIV2 - Số ước số (Bản khó) 
</div>



<div class="problem-param">
    Giới hạn thời gian: 2.0 giây
</div>
<div class="problem-param">
    Giới hạn bộ nhớ: 128 megabyte
</div>

<br/>
<div class="problem-content">
<p>Bài này giống bài NUMDIV, chỉ thay đổi giới hạn.</p>
<p>Cho n số nguyên dương a[1], a[2], ..., a[n]. Đặt M = a[1]*a[2]*...*a[n]. Tính số lượng ước số của M. In ra đáp số sau khi mod 10^9+7.</p>
<p><strong>Input:</strong></p>
<p>Dòng đầu chứa số nguyên dương n (1 &lt;= n &lt;= 10^6).</p>
<p>Dòng thứ hai chứa n số nguyên dương a[1], a[2], ..., a[n] (1 &lt;= a[i] &lt;= 5*10^6).</p>
<p><strong>Ví dụ:</strong></p>
<p>Input:</p>
<p>3</p>
<p>2 3 6</p>
<p>Output:</p>
<p>9</p>
<p> </p>
</div>
<div class="problem-sample">
<h3>Ví dụ</h3>
<ul>
</ul>
</div>
<div class="problem-explain">
<p>M = 2*3*6 = 36 có 9 ước: 1, 2, 3, 4, 6, 9, 12, 18, 36.</p>
</div>
</div>
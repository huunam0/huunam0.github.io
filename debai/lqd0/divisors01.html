<div class="tm-box2">
<div class="problem-name">
    DIVISORS01 - Tìm ước số 
</div>



<div class="problem-param">
    Giới hạn thời gian: 1.0 giây
</div>
<div class="problem-param">
    Giới hạn bộ nhớ: 512 megabyte
</div>

<br/>
<div class="problem-content">
<p style="margin-left:-.25pt"><span style="font-size:14px">Lan muốn nhờ Anh giải giúp bài toán sau: Cho một mảng số nguyên, có 2 toán tử có thể tác động lên mảng như sau:</span></p>
<ul>
<li><span style="font-size:14px">0 i x — gán giá trị <em>x </em>cho phần tử thứ <em>i</em>;</span></li>
<li><span style="font-size:14px">1 l r — trả về số lượng ước số của tích các phần tử liên tiếp trong đoạn từ <em>l </em>đến <em>r</em>. Số này có thể rất lớn nên hãy lấy phần dư trong phép chia cho 10<sup>9 </sup>+ 7.</span></li>
</ul>
<p style="margin-left:-.25pt"><span style="font-size:14px">Thực ra vì có tình ý với Lan nên Anh không thể từ chối Lan. Nhưng vốn tính lười biếng nên Anh không muốn làm việc mà muốn bí mật nhờ bạn viết hộ chương trình giải quyết bài toán dùm.</span></p>
<h2><span style="font-size:14px">Dữ liệu vào</span></h2>
<p style="margin-left:-.25pt"><span style="font-size:14px">Dòng đầu tiên chứa một số nguyên <em>n </em>là kích thước của mảng (1 ≤ <em>n </em>≤ 5 · 10<sup>4</sup>).</span></p>
<p style="margin-left:-.25pt"><span style="font-size:14px">Dòng thứ 2 chứa <em>n </em>số nguyên <em>a<sub>i </sub></em>là các phần tử của mảng (1 ≤ <em>a<sub>i </sub></em>≤ 10<sup>4</sup>).</span></p>
<p style="margin-left:-.25pt"><span style="font-size:14px">Dòng thứ 3 chứa một số nguyên <em>q </em>là số lượng yêu cầu (1 ≤ <em>q </em>≤ 10<sup>4</sup>).</span></p>
<p style="margin-left:-.25pt"><span style="font-size:14px">Mỗi dòng trong số <em>q </em>dòng tiếp theo chứa 3 số nguyên chỉ một toán tử tác động lên mảng. Nếu số đầu tiên là 0 thì sẽ thực hiện cập nhật yêu cầu này trong mảng. Nếu số đầu tiên là 1, thì chương trình cần tìm ra số ước số của tích các phần tử liên tiếp nhau trong đoạn, lấy phần dư trong phép chia cho 10<sup>9</sup>+7.</span></p>
<p style="margin-left:-.25pt"><span style="font-size:14px">Dữ liệu đảm bảo trong tất cả các yêu cầu 1 ≤ <em>i,l,r </em>≤ <em>n</em>;1 ≤ <em>x </em>≤ 10<sup>4</sup>. Kết quả</span></p>
<p style="margin-left:-.25pt"><span style="font-size:14px">Đối với mỗi yêu cầu tìm số ước số, ghi ra trên một dòng giá trị tìm được lấy phần dư cho 10<sup>9 </sup>+ 7.</span></p>
</div>
<div class="problem-sample">
<h3>Ví dụ</h3>
<ul>
</ul>
</div>
<div class="problem-explain">
<p><strong>Input</strong></p>
<p style="margin-left: 40px;">5<br/>
2 3 4 5 6<br/>
6<br/>
1 2 4<br/>
1 2 3<br/>
0 1 1<br/>
0 4 7<br/>
1 1 3<br/>
1 1 4</p>
<p><strong>Output</strong></p>
<p style="margin-left: 40px;">12<br/>
6<br/>
6<br/>
12</p>
<hr/>
<p><em>Nguồn ĐPT 20152016</em></p>
</div>
</div>
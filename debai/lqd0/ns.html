<div class="tm-box2">
<div class="problem-name">
    NS - Ông già Noel  
</div>



<div class="problem-param">
    Giới hạn thời gian: 1.0 giây
</div>
<div class="problem-param">
    Giới hạn bộ nhớ: 512 megabyte
</div>

<br/>
<div class="problem-content">
<p style="text-align: justify;"><span style="font-size:14px">Ông già Noel với bộ đồ màu đỏ viền trắng, chiếc nón đỏ, chòm râu dài trắng cùng bộ mặt hóm hỉnh và tiếng cười "hô hô hô" đã trở thành biểu tượng của phép nhiệm màu. Trẻ em trên khắp thế giới đều tin rằng, vào đêm Giáng Sinh, ông già Noel sẽ cưỡi một cỗ xe tuần lộc đi khắp thế gian, chui qua ống khói của mỗi ngôi nhà để trao những món quà vào chiếc tất đầu giường khi các em say ngủ. Để rồi sáng hôm sau, các em ai cũng háo hức và bất ngờ vì nhận được những món quà mơ ước trong lá thư các em đã viết gửi ông già Noel.</span></p>
<p style="text-align: justify;"><span style="font-size:14px">Năm nay, trường NS tổ chức đón Giáng sinh cho <em>n</em> bạn nhỏ, các bạn nhỏ đứng thành một vòng tròn và cùng nhau tham gia nhiều hoạt động. Hoạt động cuối cùng sẽ là viết thư gửi ông già Noel. Các bạn nhỏ được đánh số từ 1 đến <em>n</em> theo chiều kim đồng hồ (bạn <em>n</em> sẽ đứng cạnh bạn 1), bạn thứ <em>i</em> dự định sẽ viết thư cho ông già Noel với <em>w<sub>i</sub></em> điều ước. Tuy nhiên, các anh chị phụ trách muốn chia <em>n</em> bạn thành một số nhóm, mỗi nhóm gồm một số bạn liên tiếp trên vòng tròn và sẽ cùng nhau viết chung một bức thư gửi ông già Noel. Các nhóm đã thống nhất sẽ ghi một số điều ước vào bức thư chung của nhóm, số điều ước sẽ ghi được tính bằng ước số chung lớn nhất của tất cả các số là số điều ước của từng bạn trong nhóm. Sau khi thu thập được thông tin số điều ước của từng bạn, các anh chị phụ trách muốn chia thành các nhóm mà mỗi nhóm đều có ít nhất là hai điều ước được ghi vào bức thư chung. Một bài toán thú vị để thách đố các bạn nhỏ đó là: Có bao nhiêu cách chia nhóm thỏa mãn, hai cách chia được gọi là khác nhau nếu tồn tại hai bạn nhỏ đứng liên tiếp trên vòng tròn, ở cách này thì cùng một nhóm nhưng trong cách kia thì khác nhóm.</span></p>
<p style="text-align: justify;"><span style="font-size:14px"><strong>Yêu cầu</strong>: Cho <em>w<sub>1</sub>,w<sub>2</sub>,…,w<sub>n</sub></em>, hãy đếm số cách chia nhóm.</span></p>
<p style="text-align: justify;"><span style="font-size:14px"><strong>Dữ liệu</strong></span></p>
<p style="text-align: justify; margin-left: 40px;"><span style="font-size:14px">Dòng đầu chứa số nguyên dương <em>n</em>;<br/>
Dòng thứ hai gồm <em>n</em> số nguyên dương mô tả dãy <em>w<sub>1</sub>,w<sub>2</sub>,…,w<sub>n</sub>  (w<sub>i</sub>≤10^9)</em>.</span></p>
<p style="text-align: justify;"><span style="font-size:14px"><strong>Kết quả</strong></span></p>
<p style="text-align: justify; margin-left: 40px;"><span style="font-size:14px">Đưa ra một dòng chứa một số nguyên là số lượng cách xếp tìm được chia dư 10^9+7.</span></p>
</div>
<div class="problem-sample">
<h3>Ví dụ</h3>
<ul>
</ul>
</div>
<div class="problem-explain">
<p><span style="font-size:14px"><strong>Input</strong></span></p>
<p style="margin-left: 40px;"><span style="font-size:14px">4<br/>
2 2 5 5</span></p>
<p><span style="font-size:14px"><strong>Output</strong></span></p>
<p style="margin-left:40px"><span style="font-size:14px">4</span></p>
<p><span style="font-size:14px"><strong>Input</strong></span></p>
<p style="margin-left: 40px;"><span style="font-size:14px">3<br/>
3 6 9</span></p>
<p><span style="font-size:14px"><strong>Output</strong></span></p>
<p style="margin-left:40px"><span style="font-size:14px">5</span></p>
<p> </p>
<p><strong>Ràng buộc:</strong></p>
<p style="margin-left: 40px;"><em>Có 20% số test ứng với 20% số điểm có n≤10;<br/>
Có 20% số test khác với 20% số điểm có n≤10^2;<br/>
Có 20% số test khác với 20% số điểm có n≤10^3;<br/>
Có 20% số test khác với 20% số điểm có n≤10^4;<br/>
Có 20% số test còn lại với 20% số điểm có n≤10^5.</em></p>
<hr/>
<p><span style="font-size:14px"><em>Nguồn: 3D '1920</em></span></p>
</div>
</div>
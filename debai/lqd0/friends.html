<div class="tm-box2">
<div class="problem-name">
    FRIENDS - GÓI CƯỚC “BẠN BÈ” 
</div>



<div class="problem-param">
    Giới hạn thời gian: 1.0 giây
</div>
<div class="problem-param">
    Giới hạn bộ nhớ: 512 megabyte
</div>

<br/>
<div class="problem-content">
<h1 style="text-align:justify"><span style="font-size:14px">Một công ty có  nhân viên đánh số từ 1 tới <em>n</em>. Ông chủ công ty trang bị cho mỗi nhân viên một điện thoại di động để tiện liên lạc khi làm việc. Cước phí sử dụng điện thoại sẽ do công ty chi trả.</span></h1>
<p style="text-align:justify"><span style="font-size:14px">Sau một vài tháng hoạt động, do chi phí thanh toán các hóa đơn điện thoại khá lớn nên ông chủ quyết định tìm cách giảm chi phí bằng cách yêu cầu các nhân viên của mình đăng ký sử dụng gói cước “bạn bè” của công ty viễn thông L4T (Looking for Troubles). Gói cước “bạn bè” có đặc điểm sau:</span></p>
<ul>
<li style="text-align:justify"><span style="font-size:14px">Mỗi gói cước chỉ cho đúng hai người đăng ký tham gia, khi hai người đăng ký sử dụng gói cước “bạn bè” thì giá cước hai người đó gọi cho nhau sẽ chỉ là  <em>F</em> (đồng/phút) thay vì <em>R</em> (đồng/phút) theo cước phí thông thường.</span></li>
<li style="text-align:justify"><span style="font-size:14px">Mỗi người chỉ được tham gia không quá một gói cước “bạn bè”</span></li>
</ul>
<p style="text-align:justify"><span style="font-size:14px">Dựa vào nhu cầu công việc, ông chủ ước lượng rằng trong mỗi tháng sẽ có <em>m</em> cuộc gọi đánh số từ 1 tới <em>n</em>, cuộc gọi thứ <em>i</em> do nhân viên <em>u<sub>i</sub></em> gọi nhân viên <em>v<sub>i</sub></em> trong <em>c<sub>i</sub></em> phút. Hãy giúp ông chủ công ty yêu cầu các nhân viên của mình đăng ký sử dụng các gói cước “bạn bè” sao cho tổng số tiền điện thoại phải thanh toán hàng tháng cho các nhân viên là nhỏ nhất có thể.</span></p>
<p style="text-align:justify"><span style="font-size:14px"><strong>Dữ liệu</strong></span></p>
<ul>
<li style="text-align:justify"><span style="font-size:14px">Dòng 1: Chứa hai số nguyên dương  <em>F, R (0&lt;F&lt;R&lt;100)</em></span></li>
<li style="text-align:justify"><span style="font-size:14px">Dòng 2: Chứa số chẵn <em>n (2&lt;=n&lt;=16)</em> </span></li>
<li style="text-align:justify"><span style="font-size:14px">Dòng 3: Chứa số cuộc gọi <em>m (1&lt;=m&lt;=10000)</em> </span></li>
<li style="text-align:justify"><span style="font-size:14px"><em>m</em> dòng tiếp theo, dòng thứ <em>i</em> chứa ba số nguyên dương <em>u<sub>i</sub>, v<sub>i</sub>, c<sub>i</sub> (c<sub>i</sub>&lt;=100)  </em></span></li>
</ul>
<p style="text-align:justify"><span style="font-size:14px"><strong>Kết quả</strong></span></p>
<ul>
<li style="text-align:justify"><span style="font-size:14px">Dòng 1 ghi số tiền phải trả hàng tháng theo phương án tìm được</span></li>
<li style="text-align:justify"><span style="font-size:14px">Các dòng tiếp, mỗi dòng ghi số hiệu hai nhân viên được yêu cầu đăng ký sử dụng gói cước “bạn bè”,<em> các cặp số hiệu được xếp theo thứ tự từ điển</em></span></li>
</ul>
</div>
<div class="problem-sample">
<h3>Ví dụ</h3>
<ul>
</ul>
</div>
<div class="problem-explain">
<p><strong>Input</strong></p>
<p style="margin-left:40px">1 2<br/>
4<br/>
5<br/>
2 3 18<br/>
2 4 20<br/>
3 2 2<br/>
4 1 12<br/>
2 4 6</p>
<p><strong>Output</strong></p>
<p style="margin-left:40px">2 3<br/>
84<br/>
1 4<br/>
2 3</p>
<hr/>
<p><em>Nguồn: DHBB'14 ĐHSP</em></p>
</div>
</div>
<div class="tm-box2">
<div class="problem-name">
    CHEER - Động viên đàn bò 
</div>



<div class="problem-param">
    Giới hạn thời gian: 1.0 giây
</div>
<div class="problem-param">
    Giới hạn bộ nhớ: 128 megabyte
</div>

<br/>
<div class="problem-content">
<p style="text-align:justify"><span style="font-size:14px">Bác John dạo này lười đến nỗi không muốn bảo trì các con đường dẫn bác đến thăm <em>N</em> (5 &lt;= <em>N</em> &lt;= 10,000) cánh đồng (đánh số từ 1 đến <em>N</em>) nữa. Mỗi cánh đồng là nơi ở của một cô bò. Bác John có kế hoạch loại bỏ nhiều nhất <em>P</em> (<em>N</em>-1 &lt;= <em>P </em>&lt;= 100,000) con đường sao cho các cánh đồng vẫn liên thông.</span></p>
<p style="text-align:justify"><span style="font-size:14px">Ban phải xác định <em>N</em>-1 con đường cần giữ lại.</span></p>
<p style="text-align:justify"><span style="font-size:14px">Đường nối hai chiều <em>j</em> nối giữa cánh đồng <em>S<sub>j</sub></em> và <em>E<sub>j </sub></em>(1 &lt;= <em>S<sub>j</sub></em> &lt;= <em>N</em>; 1 &lt;= <em>E<sub>j</sub></em> &lt;= <em>N</em>; <em>S<sub>j</sub> # E<sub>j</sub></em>) và cần <em>L<sub>j </sub></em>(0 &lt;= <em>L<sub>j</sub> </em>&lt;= 1000) thời gian để di chuyển. Không có hai cánh đồng nào được nối trực tiếp bởi nhiều hơn một con đường.</span></p>
<p style="text-align:justify"><span style="font-size:14px">Đàn bò buồn vì hệ thống giao thông của chúng sắp bị rút gọn. Bạn phải thăm mỗi cô bò ít nhất một lần trong ngày để động viên. Mỗi lần thăm cánh đồng <em>i</em> (dù chỉ đi ngang qua), bạn phải trò chuyện với cô bò trong thời gian <em>C<sub>i </sub></em>(1 &lt;= </span><em>C<sub>i</sub></em><span style="font-size:14px"> &lt;= 1000).</span></p>
<p style="text-align:justify"><span style="font-size:14px">Bạn sẽ nghỉ lại đêm trên cùng một cánh đồng (bạn sẽ được chọn) cho đến khi đàn bò đều đã hết bị suy sụp. Bạn sẽ trò chuyện với cô bò trong cánh đồng mà bạn nghỉ lại ít nhất 2 lần vào buổi sáng thức dậy và vào buổi tối khi trở về nghỉ.</span></p>
<p style="text-align:justify"><span style="font-size:14px">Giả dụ bác John theo lời khuyên của bạn giữ lại một số con đường và bạn sẽ chọn cánh đồng tối ưu nhất để nghỉ lại, hãy xác định thời gian nhỏ nhất bạn cần để thăm tất cả đàn bò ít nhất một lần trong ngày.</span></p>
<h3><strong><span style="font-size:14px">Dữ liệu</span></strong></h3>
<p style="text-align: justify; margin-left: 40px;"><span style="font-size:14px">* Dòng 1: Hai số nguyên <em>N </em>và <em>P </em>cách nhau bởi khoảng trắng<br/>
* Dòng 2..<em>N</em>+1: Dòng <em>i</em>+1 chứa một số nguyên duy nhất </span><em>C<sub>i</sub></em><br/>
<span style="font-size:14px">* Dòng <em>N</em>+2..<em>N</em>+<em>P</em>+1: Dòng <em>N</em>+<em>j</em>+1 chứa ba số nguyên phân biệt: <em>S<sub>j</sub></em>, <em>E<sub>j</sub></em> và <em>L<sub>j</sub></em></span></p>
<h3><strong><span style="font-size:14px">Kết quả</span></strong></h3>
<p style="text-align: justify; margin-left: 40px;"><span style="font-size:14px">* Một số nguyên duy nhất, tổng thời gian cần để thăm tất cả đàn bò (bao gồm hai lần thăm cô bò ở nơi mà bạn nghỉ).</span></p>
<p style="text-align:justify"> </p>
</div>
<div class="problem-sample">
<h3>Ví dụ</h3>
<ul>
</ul>
</div>
<div class="problem-explain">
<p><span style="font-size:14px"><strong>Input</strong></span></p>
<p style="margin-left: 40px;"><span style="font-size:14px">5 7<br/>
10<br/>
10<br/>
20<br/>
6<br/>
30<br/>
1 2 5<br/>
2 3 5<br/>
2 4 12<br/>
3 4 17<br/>
2 5 15<br/>
3 5 6<br/>
4 5 12</span></p>
<p><span style="font-size:14px"><strong>Output</strong></span></p>
<p style="margin-left:40px"><span style="font-size:14px">176</span></p>
<hr/>
<p><span style="font-size:14px"><em>Nguồn: SPOJ</em></span></p>
</div>
</div>
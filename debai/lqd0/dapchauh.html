<div class="tm-box2">
<div class="problem-name">
    DAPCHAUH - Định và Ami (bản khó) 
</div>



<div class="problem-param">
    Giới hạn thời gian: 1.0 giây
</div>
<div class="problem-param">
    Giới hạn bộ nhớ: 256 megabyte
</div>

<br/>
<div class="problem-content">
<p>Được vinh dự trở thành thí sinh tham dự vòng chung kết ICPC toàn cầu, <span style="color:#800080"><strong>Ami</strong></span> không giấu nổi niềm kiêu hãnh hiếm hoi mà cậu có được trong năm đầu của đời sinh viên. <span style="color:rgb(128, 0, 128)"><strong>Ami</strong></span> liên tục up ảnh khoe mẽ lên Facebook, Instagram, Twitter, Lotus, etc - phủ sóng mọi nơi mà <span style="color:rgb(255, 0, 0)"><strong>cuom1999</strong></span> có thể nhìn thấy trong lúc lướt web giải trí. Quá chướng mắt với sự khủng bố tinh thần từ <span style="color:rgb(128, 0, 128)"><strong>ami</strong></span>, <span style="color:rgb(255, 0, 0)"><strong>cuom1999</strong></span> đã lên một kế hoạch thâm độc để trả thù: cưa đổ người tình Xiêm La <strong>LN</strong> của <span style="color:rgb(128, 0, 128)"><strong>ami</strong></span>.</p>
<p>    Sau khi lân la kết bạn dò hỏi, <span style="color:#FF0000"><strong>cuom1999</strong></span> biết được rằng cứ mỗi ngày rằm trong <strong>bốn</strong> tháng trời yêu xa, <span style="color:rgb(128, 0, 128)"><strong>ami</strong></span> đều sử dụng dịch vụ chuyển phát nhanh theo tuyến Texas - Bangkok để gửi cho <strong>LN</strong> một dãy bit nhị phân độ dài <strong>N</strong>. Bốn dãy bit được <strong>LN </strong>xem như là những kỷ vật tình yêu vô giá và cô đã lần lượt ký hiệu chúng là <strong>A</strong>, <strong>B</strong>, <strong>C</strong> và <strong>D</strong>. Tuy nhiên, một chuyên gia khoa học máy tính như <span style="color:rgb(255, 0, 0)"><strong>cuom1999</strong></span> đã quá quen thuộc với những con số nhị phân nên cậu tỏ ý xem thường những dãy bit này của <strong>LN</strong>. <strong>LN</strong> vừa cảm thấy bị xúc phạm thay cho <span style="color:rgb(128, 0, 128)"><strong>ami</strong></span>, vừa muốn đập tan thái độ kiêu ngạo của <span style="color:rgb(255, 0, 0)"><strong>cuom1999</strong></span> nên đã viết ra một biểu thức tình yêu cực kỳ phức tạp để thách thức <span style="color:rgb(255, 0, 0)"><strong>cuom1999</strong></span> tính toán được kết quả của nó. Một biểu thức tình yêu sẽ có dạng (<strong>X</strong> opt <strong>Y</strong>), trong đó:</p>
<p>    - <strong>X</strong> và <strong>Y</strong> là những biểu thức tình yêu khác hoặc ký hiệu cho một trong bốn dãy bit trên.</p>
<p>    - opt là một trong ba ký hiệu '|', '&amp;' và '^' - tượng trưng lần lượt cho ba toán tử logic <strong>or</strong>, <strong>and</strong> và <strong>xor</strong>.</p>
<p>    <strong>LN</strong> hứa sẽ hẹn hò với <span style="color:rgb(255, 0, 0)"><strong>cuom1999</strong></span> nếu cậu tính ra được dãy bit kết quả của biểu thức tình yêu này. Nhưng không may, biểu thức lại quá phức tạp còn <span style="color:rgb(255, 0, 0)"><strong>cuom1999</strong></span> lại đang vùi đầu vào ôn thi môn Network nên đành nhờ đến bạn. Bạn hãy giúp <span style="color:rgb(255, 0, 0)"><strong>cuom1999</strong></span> đập chậu cướp hoa nhé!</p>
<p> </p>
<p><u><strong>Định dạng input:</strong></u></p>
<p>- Dòng đầu chứa số nguyên dương <strong>N</strong> thể hiện độ dài của 4 dãy bit.</p>
<p>- 4 dòng tiếp theo lần lượt thể hiện giá trị của dãy bit A, B, C và D.</p>
<p>- Dòng cuối chứa một xâu ký tự thể hiện biểu thức tình yêu cần tính. Biểu thức có định dạng chuẩn như đề bài mô tả và không chứa dấu cách nào.</p>
<p> </p>
<p><u><strong>Định dạng output:</strong></u></p>
<p>- Một dòng duy nhất là dãy bit kết quả.</p>
<p> </p>
<p><u><strong>Ràng buộc:</strong></u></p>
<p>- <strong>N</strong> <span style="color:rgb(35, 35, 35); font-family:verdana,helvetica,sans-serif; font-size:12.8px">≤ 10<sup>6</sup></span><span style="color:rgb(35, 35, 35); font-family:verdana,helvetica,sans-serif"><span style="font-size:12.8px">.</span></span></p>
<p><span style="color:rgb(35, 35, 35); font-family:verdana,helvetica,sans-serif; font-size:12.8px">- Có tối đa 10<sup>5</sup> toán tử trong biểu thức cần tính.</span></p>
<p> </p>
</div>
<div class="problem-sample">
<h3>Ví dụ</h3>
<ul>
<li>
<div class="sample-type">input</div>
<div class="sample-value">4<br/>1110<br/>0110<br/>1001<br/>0110<br/>((A&amp;B)^(C|D))</div>
<div class="sample-type">output</div>
<div class="sample-value">1001</div>
</li>
</ul>
</div>
<div class="problem-explain">
<p> </p>
<p><u><strong>Giải thích: </strong></u></p>
<p>- A &amp; B = 1110 &amp; 0110 = 0110.</p>
<p>- C | D = 1001 | 0110 = 1111.</p>
<p>- (A &amp; B) ^ (C | D) = 0110 ^ 1111 = 1001. </p>
</div>
</div>
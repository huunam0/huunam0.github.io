<html><body><div class="tm-box2">
<div class="problem-name">
    WORDFIND2 - Trò chơi tìm chữ 2 
</div>



<div class="problem-param">
    Giới hạn thời gian: 3.0 giây
</div>
<div class="problem-param">
    Giới hạn bộ nhớ: 128 megabyte
</div>

<br/>
<div class="problem-content">
<p>Sau khi chơi <a href="http://laptrinh.ntu.edu.vn/Problem/Details/5508">Trò chơi tìm chữ</a>, Misaki đã sửa lại một tí về luật chơi để trò chơi đơn giản hơn. Cách chơi như sau: Cho bảng chữ cái kích thước NxM, cần tìm trên bảng Q dãy các chữ cái độ dài L được tạo thành bằng một trong các cách nối như sau:<br/>
  1. Nối các chữ cái nằm trên cùng 1 dòng.</p>
<p>  2. Nối các chữ cái nằm trên cùng 1 cột.</p>
<p>  3. Nối các chữ cái nằm trên đường chéo từ phía trên bên trái xuống phía dưới bên phải.</p>
<p>  4. Nối các chữ cái nằm trên đường chéo từ phía trên bên phải xuống phía dưới bên trái.</p>
<p>Thay đổi của trò chơi đó là bạn chỉ cần xác định xem <strong>có tồn tại ít nhất một cách nối</strong>  trên bảng tạo thành chữ cần tìm hay không. Bạn hãy viết chương trình trả lời câu hỏi đó nhé! <img alt="wink" src="http://laptrinh.ntu.edu.vn/Scripts/ckeditorf/plugins/smiley/images/wink_smile.png" style="height:23px; width:23px" title="wink"/></p>
<p><strong>Yêu cầu: </strong>Cho bảng chữ cái NxM và Q chữ có độ dài L cần tìm, bạn hãy xác định xem có cách nối trên bảng tạo thành chữ đó hay không.</p>
<p><strong>Dữ liệu vào:</strong></p>
<p><strong>  </strong>- Dòng đầu chứa 4 số nguyên N,M,Q,L (1 <span style="color:rgb(35, 35, 35); font-size:13.6px">≤ N,M ≤ 500 | 1 ≤ Q ≤ 10<sup>5</sup> | 1 ≤ L ≤ max(N,M)).</span></p>
<p><span style="color:rgb(35, 35, 35); font-size:13.6px">  - N dòng tiếp theo, mỗi dòng chứa M chữ cái, chữ cái a<sub>ij </sub>là chữ cái ở hàng i và cột j của bảng.</span></p>
<p><span style="color:rgb(35, 35, 35); font-size:13.6px">  - Dòng thứ N+2 là dòng trống.</span></p>
<p><span style="color:rgb(35, 35, 35); font-size:13.6px">  - Q dòng tiếp theo, mỗi dòng chứa một chữ độ dài L là chữ cần tìm.</span></p>
<p><strong><span style="color:rgb(35, 35, 35); font-size:13.6px">Dữ liệu ra:</span></strong> </p>
<p>  Gồm Q dòng tương ứng với Q chữ cần tìm, nếu tìm tồn tại cách nối thì in ra 'YES', ngược lại in ra 'NO'.</p>
<p><strong>Lưu ý: </strong>Các chữ cái sau khi nối sẽ được đọc từ trái qua phải (với cách nối 1,3,4) hoặc từ trên xuống dưới (với cách nối 2).</p>
</div>
<div class="problem-sample">
<h3>Ví dụ</h3>
<ul>
<li>
<div class="sample-type">input</div>
<div class="sample-value">8 8 3 8<br/>nawdawdh<br/>htasoyjl<br/>aauzjhvn<br/>twqcktyv<br/>rwdaodur<br/>aixdfdjm<br/>ntopjvef<br/>gzxgbmhr<br/><br/>ntucoder<br/>nhatrang<br/>lovelife</div>
<div class="sample-type">output</div>
<div class="sample-value">YES<br/>YES<br/>NO</div>
</li>
</ul>
</div>
<div class="problem-explain">
</div>
</div></body></html>
<html><body><div class="tm-box2">
<div class="problem-name">
    WORDFIND - Trò chơi tìm chữ 
</div>



<div class="problem-param">
    Giới hạn thời gian: 4.0 giây
</div>
<div class="problem-param">
    Giới hạn bộ nhớ: 128 megabyte
</div>

<br/>
<div class="problem-content">
<p>Sau kì thi VOI căng thẳng, Misaki quyết định thư giãn bằng cách chơi trò chơi tìm chữ. Cách chơi như sau: Cho bảng chữ cái kích thước NxM, cần tìm trên bảng Q dãy các chữ cái được tạo thành bằng 1 trong các cách nối như sau:<br/>
  1. Nối các chữ cái nằm trên cùng 1 dòng.</p>
<p>  2. Nối các chữ cái nằm trên cùng 1 cột.</p>
<p>  3. Nối các chữ cái nằm trên đường chéo từ phía trên bên trái xuống phía dưới bên phải.</p>
<p>  4. Nối các chữ cái nằm trên đường chéo từ phía trên bên phải xuống phía dưới bên trái.</p>
<p>Ban đầu, các chữ cái trên bảng rất dễ tìm. Nhưng sau đó độ khó của game tăng lên, kích thước của bảng, số lượng chữ lớn hơn ban đầu rất nhiều, Misaki không thể tìm hết các chữ. Bạn hãy viết chương trình giúp Misaki tìm các chữ chưa tìm được nhé! <img alt="wink" src="http://laptrinh.ntu.edu.vn/Scripts/ckeditorf/plugins/smiley/images/wink_smile.png" style="height:23px; width:23px" title="wink"/></p>
<p><strong>Yêu cầu: </strong>Cho bảng chữ cái NxM và Q chữ cần tìm, bạn hãy tìm vị trí chữ cái đầu tiên của dãy có cách nối tạo thành chữ đó.</p>
<p><strong>Dữ liệu vào:</strong></p>
<p><strong>  </strong>- Dòng đầu chứa 3 số nguyên N,M,Q (1 <span style="color:rgb(35, 35, 35); font-size:13.6px">≤ N,M ≤ 200 | 1 ≤ Q ≤ 1000).</span></p>
<p><span style="color:rgb(35, 35, 35); font-size:13.6px">  - N dòng tiếp theo, mỗi dòng chứa M chữ cái, chữ cái a<sub>ij </sub>là chữ cái ở hàng i và cột j của bảng.</span></p>
<p><span style="color:rgb(35, 35, 35); font-size:13.6px">  - Dòng thứ N+2 là dòng trống.</span></p>
<p><span style="color:rgb(35, 35, 35); font-size:13.6px">  - Q dòng tiếp theo chứa một chữ là chữ cần tìm.</span></p>
<p><strong><span style="color:rgb(35, 35, 35); font-size:13.6px">Dữ liệu ra:</span></strong> </p>
<p>  Gồm Q dòng tương ứng với Q chữ cần tìm, mỗi dòng chứa 3 số nguyên u,v,d lần lượt là số dòng, số cột và cách nối tương ứng với cách đánh số ở đề bài. Nếu có nhiều vị trí thỏa yêu cầu, in ra vị trí có số dòng nhỏ nhất. Nếu có nhiều vị trí trên dòng thỏa yêu cầu, in ra vị trí có số cột nhỏ nhất. Nếu vẫn còn nhiều cách nối ở 1 ô, in ra cách nối có số thứ tự nhỏ nhất. Nếu không tìm được vị trí thỏa yêu cầu thì in ra -1.</p>
<p><strong>Lưu ý: </strong>Các chữ cái sau khi nối sẽ được đọc từ trái qua phải (với cách nối 1,3,4) hoặc từ trên xuống dưới (với cách nối 2).</p>
</div>
<div class="problem-sample">
<h3>Ví dụ</h3>
<ul>
<li>
<div class="sample-type">input</div>
<div class="sample-value">8 8 3<br/>nawdawdh<br/>dtasoyjl<br/>hauzjhvn<br/>nwqcktyv<br/>twdaodur<br/>tixdfdjm<br/>ytopjvef<br/>azxgbmhr<br/><br/>ntucoder<br/>dhnt<br/>abcd</div>
<div class="sample-type">output</div>
<div class="sample-value">1 1 3<br/>2 1 2<br/>-1</div>
</li>
</ul>
</div>
<div class="problem-explain">
</div>
</div></body></html>
<html><body><div class="tm-box2">
<div class="problem-name">
    HMD02 - Cây phả hệ 
</div>



<div class="problem-param">
    Giới hạn thời gian: 2.0 giây
</div>
<div class="problem-param">
    Giới hạn bộ nhớ: 32 megabyte
</div>

<br/>
<div class="problem-content">
<p>Trong quá trình nghiên cứu, các nhà khoa học đã phát hiện ra một loài mới và họ đặt tên nó là Humada. Họ tiến hành bắt về một con Humada để tiến hành nghiên cứu. Nhưng trớ trêu thay con vậy này sinh sản quá nhanh. Ngày càng đông và nguy hiểm, các nhà khoa học không thể quản lí nổi vì họ chỉ có thông tin về tên và ngày sinh của các con Humada. Bây giờ các nhà khoa học cần một cấu trúc dữ liệu đủ tốt để quản lí toàn bộ các sinh vật này. Và họ nghĩ ngay đến cây phả hệ. Các nhà khoa học tiến hành vẽ cây phả hệ bằng một trình soạn thảo văn bản đơn giản với những quy tắc sau:</p>
<p>  - Tên các con Humada sẽ được viết trong một khung hình chữ nhật tạo từ các kí tự '-', '|', 'o' và '+'. Dấu '+' chỉ được đặt ở chính giữa chiều rộng của hình chữ nhật, nếu chiều rộng chẵn thì dấu '+' đặt ở vị trí chính giữa bên trái. </p>
<table border="0" cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td style="height:44px; width:143px">
<p style="margin-left:10.0pt">o--+--o</p>
<p style="margin-left:10.0pt">|anton|</p>
<p style="margin-left:10.0pt">o--+--o</p>
</td>
<td style="height:44px; width:237px">
<p style="margin-left:55.15pt">o----+----o</p>
<p style="margin-left:55.15pt">|anamarija|</p>
<p style="margin-left:55.15pt">o----+----o</p>
</td>
<td style="height:44px; width:137px">
<p style="margin-left:56.65pt">o-+--o</p>
<p style="margin-left:56.65pt">|pero|</p>
<p style="margin-left:56.65pt">o-+--o</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>Các hộp được liên kết với nhau bằng dấu '|'. Một liên kết có thể liên kết với nhiều hộp với những dấu '+' tương ứng. Các liên kết không được trùng.</p>
<table border="0" cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td style="height:74px; width:111px">
<p style="margin-left:10.0pt">+</p>
<p style="margin-left:10.0pt">|</p>
<p style="margin-left:10.0pt">o</p>
<p style="margin-left:10.0pt">|</p>
<p style="margin-left:10.0pt">+</p>
</td>
<td style="height:74px; width:227px">
<p style="margin-left:.25in">+</p>
<p style="margin-left:.25in">|</p>
<p style="margin-left:.25in">o---o---o</p>
<p style="margin-left:17.95pt">|         |</p>
<p style="margin-left:17.95pt">+       +</p>
</td>
<td style="height:74px; width:183px">
<p style="margin-left:39.15pt">+</p>
<p style="margin-left:39.15pt">|</p>
<p style="margin-left:39.15pt">o-----o-----o</p>
<p style="margin-left:39.15pt">|             |</p>
<p style="margin-left:39.15pt">+           +</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>Nếu tổ tiên có một đứa con duy nhất thì liên kết đơn được sử dụng. Ngược lại các nhà khoa học sẽ sử dụng liên kết phân nhánh. Với những đứa con lớn tuồi hơn ở bên trái. Liên kết phân nhánh có thể mở rộng theo chiều ngang với đảm bảo các đoạn kí tự '-' là bằng nhau.</p>
<p>Đừng lo lắng bạn sẽ không bị yêu cầu vẽ cây mà chỉ cần xác định số lượng kí tự được sử dụng.</p>
<p><strong>Input</strong>:</p>
<p> - Dòng đầu chứa số N (0&lt;N&lt;300001), là số lượng các con Humada.</p>
<p> - N dòng tiếp theo chứa thông tin về các con Humada theo thứ tự sinh với con lớn tuổi nhất được đánh dấu 1, con mới sinh được đánh dâu N. Mỗi dòng chứa hai thông tin sau (trừ dòng 2 chứa thông tin về con đầu tiên) gồm:</p>
<p> + Tên: chuỗi không lớn hơn 20 kí tự chứa các kí tự thường trong bảng chữ cái tiếng Anh.<br/>
 + Tổ tiên: Một số nguyên chỉ tổ tiên của con thứ i.</p>
<p><strong>Output</strong>:</p>
<p> - Một số nguyên duy nhất chỉ số kí tự tối thiểu cần sử dụng để vẽ cây phả hệ.</p>
</div>
<div class="problem-sample">
<h3>Ví dụ</h3>
<ul>
<li>
<div class="sample-type">input</div>
<div class="sample-value">3<br/>adam<br/>kain 1<br/>abel 1</div>
<div class="sample-type">output</div>
<div class="sample-value">64</div>
</li>
<li>
<div class="sample-type">input</div>
<div class="sample-value">12<br/>anton<br/>ana 1<br/>luka 1<br/>mia 2<br/>tea 3<br/>jakov 3<br/>semiramida 5<br/>dominik 5<br/>anamarija 4<br/>eustahije 4<br/>lovro 2<br/>lovro 11</div>
<div class="sample-type">output</div>
<div class="sample-value">371</div>
</li>
</ul>
</div>
<div class="problem-explain">
<p><img alt="" src="images/Untitled(3).png" style="height:627px; width:1360px"/></p>
</div>
</div></body></html>
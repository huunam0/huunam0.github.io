<h2>MAKHOA2 - Mã khóa bí mật 2</h2><div class="prob">
	Đọc đề đẹp hơn ở: <a href="https://codeforces.com/group/FLVn1Sc504/contest/274709/problem/G" target="_blank"> https://codeforces.com/group/FLVn1Sc504/contest/274709/problem/G </a><a href="https://codeforces.com/group/FLVn1Sc504/contest/272672/problem/E" target="_blank"> https://codeforces.com/group/FLVn1Sc504/contest/272672/problem/E </a><p><img alt="ConanKudo" height="225" src="http://a5.sphotos.ak.fbcdn.net/hphotos-ak-snc6/247200_10150192401168029_590918028_7014809_137233_n.jpg" style="position: relative; left: 250px; vertical-align: middle;" width="300"/></p>
<p>Hè đã về!! ConanKudo đã tự hứa sẽ làm một việc gì đó có ích trong hè này, và bây giờ là lúc anh bắt đầu.</p>
<p>ConanKudo đi thuyền tới một hòn đảo giấu vàng. Sau nhiều ngày tìm kiếm, anh phát hiện ra một chiếc hòm đã bị khóa. Hiển nhiên ConanKudo không thể phá khóa vì hệ thống kích nổ sẽ hoạt động, và cái mà anh nhận được sẽ chỉ là một đống tro. Do đó, việc tìm ra chìa khóa để mở chiếc hòm là rất cần thiết.</p>
<p>Chìa khóa này là một bảng kích thước MxN chỉ chứa các số 0 hoặc 1 (0 &lt; <strong>M</strong>, <strong>N</strong> ≤ 30). Các hàng được đánh số từ 1 đến <strong>M</strong>, và các cột được đánh số từ 1 đến <strong>N</strong>. Từ những người đến trước (và thất bại trong việc mở khóa), ConanKudo đã thu thập được <strong>M</strong>+<strong>N</strong> thông tin. Mỗi thông tin tương ứng với một hàng hoặc một cột của bảng, và có 1 trong 2 dạng:</p>
<p>Dạng 1: K<sub>i</sub> A(i,1) A(i,2) ... A(i,K<sub>i</sub>), có ý nghĩa là: Trên hàng i, có K<sub>i</sub> đoạn được tạo bởi 'dãy dài nhất các số 1 liên tiếp', và độ dài các đoạn lần lượt (từ trái sang phải) là A(i,1) A(i,2) ... A(i,K<sub>i</sub>). ('Dãy dài nhất các số 1 liên tiếp' là dãy gồm các số 1 liên tiếp và không là một dãy con của dãy các số 1 liên tiếp khác).</p>
<p>Dạng 2: K<sub>j</sub> B(j,1) B(j,2) ... B(j,K<sub>j</sub>), có ý nghĩa là: Trên cột j, có K<sub>j</sub> đoạn được tạo bởi 'dãy dài nhất các số 1 liên tiếp', và độ dài các đoạn lần lượt (từ trên xuống dưới) là B(j,1) B(j,2) ... B(j,K<sub>j</sub>).</p>
<p>Có <strong>M</strong> thông tin dạng 1 tương ứng với <strong>M</strong> hàng, và <strong>N</strong> thông tin dạng 2 tương ứng với <strong>N</strong> cột.</p>
<p>Cho kích thước bảng mã khóa, và các thông tin, hãy giúp ConanKudo xác định mã khóa.</p>
<p>Trong ít nhất 50% test, bài toán chỉ có 1 nghiệm duy nhất.</p>
<h3>Input</h3>
<ul>
<li>Dòng 1: 2 số nguyên <strong>M</strong>, <strong>N</strong> cách nhau bởi dấu cách.</li>
<li><strong>M</strong> dòng tiếp, dòng thứ i là K<sub>i</sub> A(i,1) A(i,2) ... A(i,K<sub>i</sub>) cho biết thông tin ứng với hàng i.</li>
<li><strong>N</strong> dòng tiếp, dòng thứ j là K<sub>j</sub> B(j,1) B(j,2) ... B(j,K<sub>j</sub>) cho biết thông tin ứng với cột j.</li>
</ul>
<p>Chú ý:</p>
<p>- Các dòng trắng thừa có thể xuất hiện ở bất kỳ vị trí nào trong file.</p>
<p>- Nếu một hàng không có số 1 nào, thì ràng buộc tương ứng sẽ gồm duy nhất 1 số 0.</p>
<h3>Output</h3>
<ul>
<li>Gồm <strong>M</strong> dòng, mỗi dòng <strong>N</strong> ký tự 0 hoặc 1, thể hiện mã khóa.</li>
</ul>
<p>Điểm của bạn được cho như sau:</p>
<p>Gọi D là số hàng và cột thỏa mãn điều kiện. Điểm lớn nhất có thể đạt được của một test là 2.5 điểm.</p>
<p>- Nếu D &lt;= max(<strong>M</strong>,<strong>N</strong>), bạn được 0 điểm.</p>
<p>- Nếu D = <strong>M</strong> + <strong>N</strong> bạn được 2.5 điểm.</p>
<p>- Trường hợp còn lại, bạn được</p>
<p style="text-align: center;"><img alt="" height="44" src="http://i259.photobucket.com/albums/hh288/phongtinptnk0710/makhoa2-diem.png" width="223"/></p>
<h3>Example</h3>
<table border="1" cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top" width="200">
<pre><strong>Input</strong></pre>
</td>
<td valign="top" width="200">
<pre><strong>Output</strong></pre>
</td>
<td valign="top" width="200"> </td>
</tr>
<tr>
<td>
<p>10 10<br/> 3 1 2 1<br/> 3 1 3 2<br/> 4 1 2 1 1<br/> 4 1 1 1 1<br/> 3 1 1 1<br/><br/> 2 1 1<br/> 2 2 2<br/> 2 1 1<br/> 2 1 1<br/> 2 1 1<br/><br/> 1 3<br/> 1 1<br/> 2 1 1<br/> 2 1 5<br/> 1 3<br/><br/> 2 5 1<br/> 2 1 5<br/> 1 1<br/> 1 1<br/> 1 5</p>
</td>
<td valign="top">
<p>1000110001<br/> 1000111011<br/> 1000110101<br/> 0101010001<br/> 0010010001<br/> 0001001000<br/> 0011011000<br/> 0001001000<br/> 0001001000<br/> 0001001000</p>
</td>
<td valign="top"><img alt="MAKHOA2.png" height="180" src="../../../content/voj:MAKHOA2.png" style="border-style: initial; border-color: initial;" title="Ví dụ" width="200"/></td>
</tr>
</tbody>
</table>
<p> </p>
<pre>Với output như trên, bạn sẽ được 2.5 điểm cho test này.</pre>
<pre>Trong lúc thi, bài của bạn sẽ được chấm với 50% số test của bài. Điểm tối đa bạn có thể đạt được là 50.</pre>
</div>
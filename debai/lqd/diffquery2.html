<div class="problem-title">
<h2 style="color:#393630; display: inline-block">Diff-Query (version 2)</h2>
</div><div class="content-description screen">
<div><p>Cho dãy \(A\) gồm \(N\) phần tử là các số nguyên dương \(A_1, A_2, ..., A_N\). Cho \(Q\) thao tác, thao tác thứ \(i\) sẽ có một trong hai loại như sau:</p>
<ul>
<li>\(1\) \(p_i\) \(x_i\): Thay giá trị ở vị trí \(p_i\) thành \(x_i\) (tức gán \(A_{p_i} = x_i\)).</li>
<li>\(2\) \(u_i\) \(v_i\): Đếm số phần tử phân biệt và tính tổng các giá trị phân biệt trong đoạn từ \(u_i\) tới \(v_i\).</li>
</ul>
<p><strong>Yêu cầu</strong>: Thực hiện tất cả \(Q\) thao tác, và in ra \(2\) kết quả của thao tác loại \(2\).</p>
<p><strong>Dữ liệu vào</strong>: Gồm \(Q+2\) dòng:</p>
<ul>
<li>Dòng thứ nhất gồm hai số nguyên dương \(N, Q\).</li>
<li>Dòng thứ hai gồm \(N\) số nguyên dương \(A_1, A_2, ..., A_N\) \((A_i \leq 10^9)\).</li>
<li>\(Q\) dòng tiếp theo, với dòng thứ \(i\): số đầu tiên trên dòng là \(1\) hoặc \(2\). Số \(1\) theo sau bởi hai số nguyên dương \(p_i\), và \(x_i\) \((1 \leq p_i\leq N\), \(1 \leq x_i \leq 10^9)\). Số \(2\) theo sau bởi hai số nguyên dương \(u_i\) và \(v_i\) \((1 \leq u_i \leq v_i \leq N)\). </li>
</ul>
<p><strong>Kết quả</strong>: Với thao tác loại \(2\) có dạng \(2\) \(u\) \(v\), in ra \(2\) kết quả lần lượt là số phần tử phân biệt và tính tổng các giá trị phân biệt trong đoạn từ \(u\) tới \(v\).</p>
<p><strong>Ràng buộc</strong>:</p>
<ul>
<li>\(30\)% số test đầu tiên tương ứng với \(30\)% số điểm có \(N \leq 2.10^3\), \(Q \leq 2.10^3\).</li>
<li>\(30\)% số test tiếp theo tương ứng với \(30\)% số điểm có \(N \leq 5.10^4\), \(Q \leq 5.10^4\), chỉ có các thao tác loại \(2\).</li>
<li>\(40\)% số test còn lại tương ứng với \(40\)% số điểm có  \(N \leq 5.10^4\), \(Q \leq 5.10^4\).</li>
</ul>
<p><strong>Ví dụ</strong>:</p>
<p><strong>Input</strong>:</p>
<pre><code>3 3
1 2 3
2 1 3
1 3 2
2 2 3</code></pre>
<p><strong>Output</strong>:</p>
<pre><code>3 6
1 2</code></pre>
</div>
<hr/>
</div>
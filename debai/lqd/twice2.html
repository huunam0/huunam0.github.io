<div class="problem-title">
<h2 style="color:#393630; display: inline-block">TWICE (bản khó)</h2>
</div><div class="content-description screen">
<div><p><strong>Lưu ý: Bản này khác bản dễ ở time limit.</strong></p>
<p><span class="rating rate-master user"><a href="/user/SPyofgame">SPyofgame</a></span> đang thực hiện một thử thách: đạt được mức Expert codeforces trong 1 tháng hoặc mất 50k. Trong lúc luyện tập, anh ấy gặp một bài toán.</p>
<p>Cho mảng \(A\) gồm \(N\) phần tử, phần tử thứ \(i\) có giá trị \(A[i]\). Có \(Q\) truy vấn, mỗi truy vấn gồm hai số nguyên \(L\) và \(R\). Câu trả lời cho truy vấn này là có bao nhiêu giá trị khác nhau xuất hiện chính xác 2 lần trong đoạn \([L;R]\) đó</p>
<p><strong>INPUT</strong></p>
<ul>
<li>Dòng thứ nhất chứa hai số nguyên \(N,Q\) \((1 \leq N,Q \leq 500 000)\)</li>
<li>Dòng thứ hai là các số nguyên \(A[i]\) \((A[i] \leq 1 000 000 000)\)</li>
<li>\(Q\) dòng tiếp theo, mỗi dòng chứa hai số nguyên dương \(L, R \ (1 \leq L \leq R \leq N)\)</li>
</ul>
<p><strong>OUTPUT:</strong> Gồm Q dòng, mỗi dòng là câu trả lời của từng truy vấn</p>
<p><strong>Ví Dụ:</strong></p>
<p><strong>INPUT:</strong></p>
<pre><code>5 1
1 2 1 1 1
1 3</code></pre>
<p><strong>OUTPUT:</strong></p>
<pre><code>1</code></pre>
</div>
<hr/>
</div>
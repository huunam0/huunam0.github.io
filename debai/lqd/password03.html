<div class="problem-title">
<h2 style="color:#393630; display: inline-block">Mật khẩu (DHBB CT)</h2>
</div><div class="content-description screen">
<div><p>Do dịch Covid-19, hai bạn Hồng và Chi không được đi học và gặp nhau nhưng hai bạn vẫn
thường xuyên nhắn tin cho nhau. Một lần, Hồng muốn gửi mật khẩu tham gia lớp học online
cho Chi nhưng không muốn em Phúc tò mò và biết được. Theo ý tưởng giấu tin trong ảnh,
Hồng quyết định sẽ giấu mật khẩu vào trong đoạn văn bản gửi cho Chi. Cụ thể, với một văn
bản mà Hồng gửi cho Chi được biểu diễn bằng xâu ký tự \(𝑇 = 𝑡_1 𝑡_2 … 𝑡_𝑛\) (gồm \(𝑛\) ký tự, mỗi ký
tự thuộc ′\(𝑎\)′ đến ′\(𝑧\)′) và dãy số nguyên \(𝑎_1, 𝑎_2, … , 𝑎_𝑚\) (\(1 ≤ 𝑎_1 &lt; 𝑎_2 &lt; ⋯ &lt; 𝑎_𝑚 ≤ 𝑛\)) là dãy số
mà hai bạn đã thống nhất thì mật khẩu là một xâu \(𝑃 = 𝑡_{𝑎_1}𝑡_{𝑎_2} … 𝑡_{𝑎_𝑚}\), là xâu độ dài \(𝑚\) nhận
được bằng cách ghép lần lượt các ký tự ở các vị trí \(𝑎_1, 𝑎_2, … , 𝑎_𝑚\). Ví dụ, \(𝑇 =\) ′\(𝑚𝑖𝑠𝑠𝑦𝑜𝑢𝑢𝑢\)′
và dãy số \(𝑎_1 = 2, 𝑎_2 = 3, 𝑎_3 = 5, 𝑎_4 = 6, 𝑎_5 = 8\) thì mật khẩu là \(𝑃 =\) “\(𝑖𝑠𝑦𝑜𝑢\)”.</p>
<p>Hồng nhanh chóng nhận ra rằng, với một xâu \(𝑇\) và mật khẩu \(𝑃\) sẽ tồn tại nhiều dãy số để xác
định mật khẩu. Ví dụ, một dãy số khác \(𝑎_1 = 2, 𝑎_2 = 4, 𝑎_3 = 5, 𝑎_4 = 6, 𝑎_5 = 7\) cũng xác định
được mật khẩu \(𝑃 =\) “\(𝑖𝑠𝑦𝑜𝑢\)” trong xâu \(𝑇 =\) ′\(𝑚𝑖𝑠𝑠𝑦𝑜𝑢𝑢𝑢\)′.</p>
<p>Trong quá trình gửi, xâu \(𝑇\) sẽ được mã hóa theo phương thức <strong>RLE</strong> (Run Length Encoding).
Nghĩa là, một xâu \(𝑇\) chỉ gồm các ký tự ‘\(𝑎\)’ đến ‘\(𝑧\)’ được mã hóa thành xâu \(𝑇𝐸\) (chỉ gồm các ký
tự ‘\(𝑎\)’ đến ‘\(𝑧\)’ và ký tự ‘\(0\)’ đến ‘\(9\)’) bằng cách đi từ trái sang phải, mã hoá dãy các ký tự liên tiếp
giống nhau trong \(𝑇\) thành ký tự đại diện và số lượng.</p>
<p>Ví dụ, xâu \(𝑇 =\) ′\(𝑚𝑖𝑠𝑠𝑦𝑜𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢\)′ thì \(𝑇𝐸 =\) ′\(𝑚1𝑖1𝑠2𝑦1𝑜1𝑢10\)′.</p>
<p><strong>Yêu cầu</strong>: Cho xâu \(𝑇𝐸\) (là mã hóa của xâu \(𝑇\)) và xâu mật khẩu \(𝑃\), gọi \(𝑅\) là số lượng dãy số khác
nhau có thể xác định được mật khẩu \(𝑃\) trong xâu \(𝑇\). Hãy tính \(𝑅\) chia dư cho \(10^9 + 7\).</p>
<p><strong>Dữ liệu vào</strong></p>
<ul>
<li>Dòng đầu chứa hai số nguyên dương \(𝑛, 𝑚\);</li>
<li>Dòng thứ hai chứa một xâu là mã hóa của xâu \(T\)</li>
<li>Dòng thứ ba chứa một xâu là xâu \(𝑃\).</li>
</ul>
<p><strong>Kết quả</strong></p>
<ul>
<li>Ghi ra một số nguyên duy nhất là số \(𝑅\) chia dư cho \(10^9 +7\)</li>
</ul>
<p><strong>Sample Input 1</strong></p>
<pre><code>9 5
m1i1s2y1o1u3
isyou</code></pre>
<p><strong>Sample Output 1</strong></p>
<pre><code>6</code></pre>
<p><strong>Sample Input 2</strong></p>
<pre><code>11 3
m1i1s2i1s2i1p2i1
isi</code></pre>
<p><strong>Sample Output 2</strong></p>
<pre><code>14</code></pre>
<p><strong><em>Giới hạn</em></strong></p>
<ul>
<li>Có 20% số lượng test ứng với 20% số điểm thỏa mãn điều kiện: \(𝑛 ≤ 20, 𝑚 = 1\);</li>
<li>Có 20% số lượng test khác ứng với 20% số điểm thỏa mãn điều kiện: \(𝑛 ≤ 20, 𝑚 &lt; 𝑛\);</li>
<li>Có 20% số lượng test ứng khác với 20% số điểm thỏa mãn điều kiện: \(𝑛 ≤ 10^5, 𝑚 = 3\);</li>
<li>Có 20% số lượng test khác ứng với 20% số điểm thỏa mãn điều kiện: \(𝑛 ≤ 10^5, 𝑚 ≤ 30\);</li>
<li>Có 20% số lượng test còn lại ứng với 20% số điểm thỏa mãn điều kiện: \(𝑛 ≤ 10^9, 𝑚 ≤30\) và xâu mã hóa của xâu \(𝑇\) có độ dài không vượt quá \(10^5\)</li>
</ul>
<hr/>
<p><em>Nguồn: 2020 Chính thức</em></p>
</div>
<hr/>
</div>
<div class="problem-title">
<h2 style="color:#393630; display: inline-block">Tổ hợp (Version 2)</h2>
</div><div class="content-description screen">
<div><p>Cho số nguyên \(P\) có dạng như sau:
\(P\) \(=\) \({p_1}^{e_1} . {p_2}^{e_2} .\)  ...  \(. {p_k}^{e_k}\) , sao cho với \(\forall i, 1 \leq i \leq k\), \(p_i\) là số nguyên tố, \(k_i \geq 1\) và \({p_i}^{k_i} \leq 2.10^5\)</p>
<p>Cho \(T\) truy vấn, mỗi truy vấn gồm hai số \(N, K\) \((K \leq N)\). Với mỗi truy vấn, bạn hãy tính \(\binom{N}{K}\) \(mod\) \(P\).</p>
<h4>Dữ liệu vào</h4>
<ul>
<li>Dòng đầu tiên chứa \(2\) số nguyên dương \(T, P\) \((T \leq 10^4)\) lần lượt là số lượng truy vấn và số cho trước.</li>
<li>\(T\) dòng tiếp theo, mỗi dòng chứa \(2\) số nguyên dương \(N, K\).</li>
</ul>
<h4>Kết quả</h4>
<p>Với mỗi truy vấn, in ra một số nguyên là đáp số của truy vấn đó.</p>
<h4>Ràng buộc</h4>
<ul>
<li>\(30\%\) số test đầu tiên tương ứng với \(30\%\) số điểm có \(N, K \leq 10^3\); \(P \leq 10^9\).</li>
<li>\(20\%\) số test tiếp theo tương ứng với \(20\%\) số điểm có \(N, K \leq 10^5\); \(P \leq 2.10^5\), \(P\) là số nguyên tố.</li>
<li>\(20\%\) số test tiếp theo tương ứng với \(20\%\) số điểm có \(N, K \leq 10^5\); \(P \leq 10^9\).</li>
<li>\(30\%\) số test tiếp theo tương ứng với \(30\%\) số điểm có \(N, K \leq 10^9\); \(P \leq 10^9\).</li>
</ul>
<h4>Ví dụ</h4>
<p><strong>Input</strong></p>
<pre><code>3 8
7 4
6 3
5 2</code></pre>
<p><strong>Output</strong></p>
<pre><code>3
4
2</code></pre>
<p><strong>Chú thích</strong>: \(\binom{N}{K}\) là tổ hợp chập \(K\) của \(N\).</p>
<p><strong>Nguồn</strong>: Bản khó hơn của bài <a href="http://lqdoj.edu.vn/problem/combi" rel="nofollow">Tổ hợp</a></p>
</div>
<hr/>
</div>
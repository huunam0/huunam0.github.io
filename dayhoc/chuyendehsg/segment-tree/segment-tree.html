<html xmlns:m="http://www.w3.org/1998/Math/MathML">
<head>
 <meta charset="utf8"/>
 <title>Segment Tree - Cây phân đoạn</title>
 <meta name="author" value="Tran Huu Nam"/>
 <link rel="stylesheet" href="../../inc/chung.css">
 <link rel="stylesheet" href="../../inc/mathjax/mathjax_styles.css">
 <script src="../../inc/mathjax/tex-mml-chtml.js" id="MathJax-script" async></script>
 <script src="../../inc/jquery.min.js" type="text/javascript"></script>
 <script src="../../inc/jquery-ui.min.js" type="text/javascript"></script>
 <link rel="stylesheet" href="../../inc/jquery-ui.min.css">
 <script src="../../inc/chung.js" type="text/javascript"></script>
 
</head>
<body>

<h1>Segment Tree - Cây phân đoạn</h1>
<p><strong>1. Khái niệm:</strong></p>
<p class="mucan">Segment tree (ST) là cây nhị phân đầy đủ. Mỗi nút quản lí 1 đoạn (VD: tổng, tích, max, min, ucln,... của một đoạn).</p>
<p class="mucan">Trong ví dụ minh hoạ sau đây, ta giả sử mỗi nút là tổng của một đoạn. ST cho phép tính nhanh tổng của 1 đoạn bất kì.</p>
<p class="mucan">Giả sử ta có mảng A gồm n phần tử : A[1..n]. Thì cây ST sẽ được biểu diễn bởi mảng H[1..4n]:</p>
<p class="mucan">Nút 1 - là nút gốc sẽ quản lí toàn bộ mảng, tức là đoạn 1..n: H[1]=Sum(A[1..n])</p>
<p class="mucan">Nút 1 có hai nút con là 2 và 3, nút 2 quản lí nửa trước \(1..\frac{n+1}{2}\), nút 3 quản lí nửa sau: \(\frac{n+1}{2}+1..n\)</p>
<p class="mucan"><strong>Tổng quát: </strong></p>
<p class="mucan">a. Nếu nút v quản lí đoạn L..R: H[v] = sum(A[L..R])</p>
<p class="mucan">Nút v sẽ có 2 nút con là 2v và 2v+1.</p>
<p class="mucan">Đặt M = (L+R)/2.</p>
<p class="mucan">Nút con 2v quản lí đoạn L..M: H[2v]=sum(A[L..M])</p>
<p class="mucan">Nút con 2v+1 quản lí đoạn M+1..R: H[2v]=sum(A[M+1..R])</p>
<p class="mucan">Ta thấy: H[v] = H[2v] + H[2v+1] (nút cha bằng tổng 2 nút con của cây ST)</p>
<p class="mucan">b. Nút v có nút cha là v/2.</p>
<p class="mucan"><strong>Ví dụ:</strong></p>
<p class="mucan">Xét mảng A có 7 phần tử A = [3,  8,  4,  5,  8,  5,  1]. Cây ST sẽ như sau:</p>
<div>
<img class="mucan" src="img/segment-tree-1.png"/><br/>
<img class="mucan" src="img/segment-tree-2.png"/><br/>
<img class="mucan" src="img/segment-tree-3.png"/><br/>
<img class="mucan" src="img/segment-tree-4.png"/><br/>

</div>
<table border="1" cellpadding="0" cellspacing="0" class="mucan">
	<tbody>
		<tr>
			<td><em>i</em></td>
			<td><em>1</em></td>
			<td><em>2</em></td>
			<td><em>3</em></td>
			<td><em>4</em></td>
			<td><em>5</em></td>
			<td><em>6</em></td>
			<td><em>7</em></td>
			<td><em>8</em></td>
			<td><em>9</em></td>
			<td><em>10</em></td>
			<td><em>11</em></td>
			<td><em>12</em></td>
			<td><em>13</em></td>
		</tr>
		<tr>
			<td>A[i]</td>
			<td>3</td>
			<td>8</td>
			<td>4</td>
			<td>5</td>
			<td>8</td>
			<td>5</td>
			<td>1</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>H[i]</td>
			<td>34</td>
			<td>20</td>
			<td>14</td>
			<td>11</td>
			<td>9</td>
			<td>13</td>
			<td>1</td>
			<td>3</td>
			<td>8</td>
			<td>4</td>
			<td>5</td>
			<td>8</td>
			<td>5</td>
		</tr>
	</tbody>
</table>
<p class="mucan"><strong>2. Các thao tác trên ST:</strong></p>
<ul>
	<li class="mucan">Xây dựng cây ST (mảng H)</li>
	<li class="mucan">Truy vấn trên đoạn (tính tổng trên 1 đoạn p..q)</li>
	<li class="mucan">Cập nhật giá trị một phần tử (gán A[i]=x)</li>
</ul>
<p>&nbsp;</p>
<p class="mucan">Tài liệu tham khảo:</p>
<ul>
	<li class="mucan">https://www.geeksforgeeks.org/segment-tree-set-1-sum-of-given-range/</li>
</ul>

<div></div>
</body>
</html>